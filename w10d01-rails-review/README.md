### Rails Review and All things Rails

I hope you had a good week going through Jungle and finished up main side of it.
Today we will be doing a quick overview of rails + some advanced topics in it.


#### Review - What is Rails??

Ruby on Rails, or Rails, is a server-side web application framework written in Ruby under the MIT License. Rails is a model–view–controller framework, providing default structures for a database, a web service, and web pages.

Key things to remember that

 - `routes.rb` is the entry point of your app. All route paths go here and are connected to the corresponding controller that will.

 - Controller is responsible for logic and getting the `@` variables to your view. Remember that the methods : `create, index, show` are names the views that will be rendered for thouse methods. ( Hence, when you call `/authors` route, it will hit the `authorsController`  which will use the `index` method)

 - Model is resposible for the connectivity to the database and handling database queries. ( A better answer is: for handling data and business logic)

 - Views are files that handle the GUI for the user. Essential rails server-side renders the views, and sends them out the client.

#### Commands used in Demo

`rails g model Author` <- creates migration and model for author
`rails g controller authors` <- creates authors controller (notice plural)
`rails g scaffold ______` <- to generate an entire scaffold of view controllers model and migrations [Scaffold Reference](https://qiita.com/Kolosek/items/697ad33bb82932ebed73)

#### Rails influenced alot of Features for Other MVC Frameworks
As we discussed some of the features, key things to also remember that learning MVC pattern is beneficial, due to the amount of MVC frameworks.


#### Nested Routes

We define the nesting in our routes. In routes.rb you say:

```ruby
  resources :authors do
    resources :books
  end
```

Will generate

```
 product_books GET    /authors/:author_id/books(.:format)                                                  books#index
                 POST   /authors/:author_id/books(.:format)                                                  books#create
 new_product_review GET    /authors/:author_id/books/new(.:format)                                              books#new
 edit_product_review GET    /authors/:author_id/books/:id/edit(.:format)                                         books#edit
 product_review GET    /authors/:author_id/books/:id(.:format)                                              books#show
                PATCH  /authors/:author_id/books/:id(.:format)                                              books#update
                PUT    /authors/:author_id/books/:id(.:format)                                              books#update
                DELETE /authors/:author_id/books/:id(.:format)                                              books#destroy
```

Notice that these routes will be affected by the `books` Controller.
 All the logic will go there to work with these nested routes.


 There are some nice helpful path helpers that get generated by this nested resource stuff. If you look at rake routes, you'll see the prefixes for these under PREFIX. For example, the path `/authors/5/books` could be generated by calling product_review(@product).


### Namespaces

Namespacing gives us a way to define a bunch of routes that should be followed by some prefix (e.g. .../dashboard/...). We can do this in the routes file:

```ruby
  namespace :dashboard do
    resources :authors
  end

```

The example above will generate a bunch of /dashboard/authors/... routes, and point them to particular actions in the relevant controllers. Remeber that these said controllers now live in a folder called `dashboard` ( Kinda what you have on jungle where there is an `admin` folder and some controllers live in there )


## Working with Rspec

Add Rspect to dev and test

```ruby
group :test do
  # Adds support for Capybara system testing and selenium driver
  gem 'rspec-rails'

...

group :development do
  # Access an interactive console on exception pages or by calling 'console' anywhere in the code.
  gem 'rspec-rails'

```


Run this command to generate rspec setup/helper files.

```sh
rails generate rspec:install
```

To generate a new rspec file you will write:

```sh
rails generate rspec:model url
```


To run the tests you will do either

```sh
bundle exec rspec

# OR

rspec
```

Write your model tests to see if any validations flags may pass through.
Check to make sure you cannot save something without dependancies:

here are some sample tests:

```ruby
require 'rails_helper'

RSpec.describe Url, type: :model do
  describe 'model: url validations' do
    it 'tries to save a url normally' do
      User.create(email: 'v@g.ca', password: '1234')
      url = Url.new
      url.longURL = 'www.google.ca'
      url.shortURL = 'asd234'
      url.user_id = 1;
      url.save
      expect(url.valid?).to be true
    end

    it 'tries to save a url with no shortURL and fails' do
      url = Url.new
      url.longURL = 'www.google.ca'
      url.save
      expect(url.valid?).to be false
      expect(url.errors.messages[:shortURL]).to include "can't be blank"
    end
  end
end

```


```ruby


